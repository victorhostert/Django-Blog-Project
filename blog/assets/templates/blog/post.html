{% extends 'base.html' %}

{% block 'title' %}
{{article.slug}}
{% endblock %}

{% block 'content' %}
    <div class="post">
        <h2 class="post_title"><a href="{% url 'blog:post' slug=article.slug %}">{{article.title}}</a></h2>
        <div class="post_content">
            <p>{{ article.content }}</p>
        </div>
        {% if article.thumb %}
        <img src="{{article.thumbnail.url}}" alt="user-img">
        {% endif %}
        <div class="article_footer">
            <p>{{article.date}}</p>
            <p>{{article.category}}</p>
            <p class="article_author">Posted by: <span>{{article.author.username}}</span></p>
        </div>
    </div>
    {% if comments %}
    <div class="comments" id="comments">
        <h2>Comments:</h3>
        {% for comment in comments %}
        <div class="comment" id="comment{{comment.id}}">
            <h3>{{comment.author}}:</h3>
            <p class="comment_content">{{comment.content}}</p>
            <p>{{comment.date}}</p>
            {% if user == comment.author %}
                <div class="comment_options">
                        <form action="{% url 'blog:comment_update' id=comment.id slug=article.slug %}" method='POST'>
                            {% csrf_token %}
                            <textarea name="update_comment" id="update_comment" cols="30" rows="2" placeholder="Update your comment"></textarea>
                            <button type="submit">Update</button>
                        </form>
                        <form action="{% url 'blog:comment_delete' id=comment.id slug=article.slug %}" method='POST'>
                            {% csrf_token %}
                            <button type="submit">Delete</button>
                        </form>
                </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% if user.is_authenticated %}
    <div class="create_comment">
        <form action="{% url 'blog:post' slug=article.slug %}", method="POST">
            <h3>Leave a comment:</h3>
            {% csrf_token %}
            {{form}}
            <button type="submit">Submit</button>
        </form>
    </div>
    {% endif %}

    <div class="update_delete">
        {% if user.is_authenticated and user == article.author%}
        <div class="options">
            <a href="{% url 'blog:update' slug=article.slug %}">Update this Article</a>
            <a href="{% url 'blog:delete_proceed' slug=article.slug %}">Delete this Article</a>
        </div>
    {% endif %}
    </div>
{% endblock %}